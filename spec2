
atpData = {
  trades: trades.map(trade => ({ opicsId: trade.opicsId })), // Map trades with opicsId
  totalNoOfAtps: cumulative?.atps?.length || 0, // Total count of ATPs
  atps: cumulative?.atps?.map(atp => ({
    atpId: atp?.details?.atpId || null, // ATP ID from details
    referenceDocId: atp?.referenceDocId || null, // Reference Doc ID
    name: atp?.name || 'ATP', // Default name as 'ATP'
    details: { 
      ...atp?.details, // Include all details
      sumOfBuyAmounts: undefined // Exclude specific field if needed
    },
    purpose: { ...atp?.purpose }, // Include purpose
    fxDisposition: { ...atp?.fxDisposition }, // Include FX disposition
    intendedBeneficiary: { ...atp?.intendedBeneficiary }, // Include intended beneficiary
    supportingDocs: atp?.supportingDocs || null // Include supporting docs if available
  }))
};
